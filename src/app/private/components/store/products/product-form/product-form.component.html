<app-view-header>
  <button pButton icon="pi pi-arrow-left" (click)="goBack()" pTooltip="Voltar" tooltipPosition="left"></button>
  <button pButton icon="circle-xmark" pTooltip="Limpar campos" tooltipPosition="bottom" (click)="clearFields()" class="p-button-danger">
    <fa-icon icon="circle-xmark"></fa-icon>
  </button>
  <button pButton icon="check" pTooltip="Salvar produto" [hideDelay]="500" tooltipPosition="left" class="p-button-success" (click)="save()" [disabled]="!canSave()">
    <fa-icon icon="check"></fa-icon>
  </button>
</app-view-header>
<section class="content-wrapper">
  <p-card class="products" header="Produto">
    <form [formGroup]="productsForm" enctype="multipart/form-data">
      <div class="top-content">
        <section class="img-container">
          <img [src]="thumbnailSrc" alt="imagem do produto"/>
          <button pButton (click)="file.click()" pTooltip="Escolher imagem" class="select-file-btn p-button-rounded">
            <fa-icon icon="paperclip" size="xl"></fa-icon>
          </button>
          <input type="file" hidden (change)="handleSelectFile($event)" #file accept="image/*"/>
        </section>
        <section class="form-fields">
          <!-- Product code -->
          <div class="field">
            <div class="control">
              <p>Código</p>
              <input type="text" pInputText formControlName="code" class="p-inputtext-sm"/>
            </div>
          </div>
          <!-- Product name -->
          <div class="field">
            <div class="control">
              <p>Nome</p>
              <input type="text" pInputText formControlName="name" class="p-inputtext-sm"/>
            </div>
          </div>
          <!-- Product state -->
          <div class="field">
            <div class="control"><p>Disponibilidade</p>
              <p-dropdown [options]="saleItemState" formControlName="state" optionLabel="value" [filter]="true"
                          filterBy="value" [showClear]="true" [resetFilterOnHide]="true"
                          dataKey="key" optionValue="key" placeholder="Informe a disponibilidade"
                          filterPlaceholder="Filtrar..." class="p-dropdown-sm"></p-dropdown>
            </div>
          </div>
          <!-- Product price -->
          <div class="field">
            <div class="control">
              <p>Preço</p>
              <p-inputNumber [showButtons]="true" buttonLayout="horizontal" decrementButtonIcon="pi pi-minus" incrementButtonIcon="pi pi-plus" formControlName="price"
                             locale="pt-PT" class="p-inputtext-sm" mode="currency" [maxFractionDigits]="2" currency="AOA"></p-inputNumber>
            </div>
          </div>
          <!-- Product Category -->
          <div class="field multi-column" formGroupName="category">
            <div class="control">
              <p>Categoria</p>
              <p-dropdown [options]="categories" formControlName="id" optionLabel="name" [filter]="true" filterBy="name" [showClear]="true" dataKey="id" [resetFilterOnHide]="true" [lazy]="true"
                          placeholder="Escolha uma categoria" filterPlaceholder="Filtrar..." optionValue="id" emptyMessage="Nenhuma categoria cadastrada" class="p-dropdown-sm"></p-dropdown>
            </div>
            <button pButton icon="pi pi-plus" class="p-button-rounded p-button-sm" pTooltip="Nova categoria" [showDelay]="500" [hideDelay]="250" (click)="newCategory()"></button>
          </div>
          <!-- Product Brand -->
          <div class="field multi-column" formGroupName="brand">
            <div class="control">
              <p>Marca</p>
              <p-dropdown [options]="brands" formControlName="id" optionLabel="name" [filter]="true" filterBy="name" [showClear]="true" dataKey="id" [resetFilterOnHide]="true" [lazy]="true"
                          placeholder="Selecione uma marca" filterPlaceholder="Filtrar..." optionValue="id" emptyMessage="Nenhuma marca cadastrada" class="p-dropdown-sm"></p-dropdown>
            </div>
            <button pButton icon="pi pi-plus" pTooltip="Nova marca" [showDelay]="500" [hideDelay]="250" (click)="newBrand()" class="p-button-rounded p-button-sm"></button>
          </div>
        </section>
      </div>
      <!-- Product description -->
      <div class="field">
        <div class="control">
          <p>Descrição</p>
          <textarea pInputTextarea cols="60" rows="5" formControlName="description" [autoResize]="true" [maxlength]="maxDescriptionLength"></textarea>
        </div>
      </div>
    </form>
  </p-card>
</section>
<p-toast hideTransitionOptions="500ms" [preventOpenDuplicates]="true"></p-toast>
